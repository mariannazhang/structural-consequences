"0","# Power analysis by simulation, given children's predicted responses"
"0","sample_size = 150"
"0","condition_size = sample_size/3"
"0",""
"0","predicted <- tibble("
"0","  # Set up table"
"0","  condition = rep(c(""Internalist (biological)"", ""Internalist (cultural)"", ""Structural""), each = condition_size * 3), #*3 because 3 measures"
"0","  measure = rep(c(""Possibility of change"", ""Normativity"", ""Target of intervention""), each = condition_size, times = 3), #*3 conditions"
"0","  participant = c(rep(seq(from = 1, to = condition_size, by = 1), times = 3),"
"0","                  rep(seq(from = condition_size + 1, to = condition_size*2, by = 1), times = 3),"
"0","                  rep(seq(from = condition_size*2 + 1, to = condition_size*3, by = 1), times = 3)),"
"0","  "
"0","  "
"0","  # Simulate responses"
"0","  response = "
"0","    c(#Internalist (biological): Possibility of change"
"0","      sample(c(1, 2, 3, 4), # response options"
"0","             size = condition_size,"
"0","             replace = TRUE,"
"0","             prob = c(0.4, 0.4, 0.2, 0.1)), # weighted mean = 2.2 of 1-4"
"0","      #Internalist (biological): Normativity"
"0","      sample(c(1, 2, 3, 4, 5, 6), "
"0","             size = condition_size, "
"0","             replace = TRUE,"
"0","             prob = c(0.2, 0.3, 0.2, 0.15, 0.1, 0.05)), # weighted mean = 2.8 of 1-6"
"0","      #Internalist (biological): Target of intervention"
"0","      sample(c(""Internal"", ""Structural"", ""Other""), "
"0","             size = condition_size, "
"0","             replace = TRUE,"
"0","             prob = c(0.6, 0.1, 0.3)), "
"0","      "
"0","      "
"0","      #Internalist (cultural): Possibility of change"
"0","      sample(c(1, 2, 3, 4), "
"0","             size = condition_size, "
"0","             replace = TRUE,"
"0","             prob = c(0.2, 0.4, 0.25, 0.15)), # weighted mean = "
"0","      #Internalist (cultural): Normativity"
"0","      sample(c(1, 2, 3, 4, 5, 6), "
"0","             size = condition_size, "
"0","             replace = TRUE,"
"0","             prob = c(0.15, 0.3, 0.25, 0.15, 0.1, 0.05)), # weighted mean = 2.9 of 1-6"
"0","      #Internalist (cultural): Target of intervention"
"0","      sample(c(""Internal"", ""Structural"", ""Other""), "
"0","             size = condition_size, "
"0","             replace = TRUE,"
"0","             prob = c(0.4, 0.3, 0.3)), "
"0","      "
"0","      "
"0","      #Structural: Possibility of change"
"0","      sample(c(1, 2, 3, 4), "
"0","             size = condition_size, "
"0","             replace = TRUE,"
"0","             prob = c(0.1, 0.2, 0.4, 0.3)), # weighted mean = 2.9 of 1-4"
"0","      #Structural: Normativity"
"0","      sample(c(1, 2, 3, 4, 5, 6), "
"0","             size = condition_size, "
"0","             replace = TRUE,"
"0","             prob = c(0.05, 0.1, 0.2, 0.25, 0.3, 0.1)),"
"0","      #Structural: Target of intervention"
"0","      sample(c(""Internal"", ""Structural"", ""Other""), "
"0","             size = condition_size, "
"0","             replace = TRUE,"
"0","             prob = c(0.2, 0.6, 0.2))) # weighted mean = 3.95 of 1-6"
"0","  "
"0",")"
"0",""
"0",""
"0","# Summarize simulated responses"
"0","predicted_summary <- predicted %>% "
"0","  group_by(condition, measure) %>% "
"0","  summarize(avg = mean(response, na.rm = TRUE),"
"0","            sd = sd(response, na.rm = TRUE), "
"0","            n = length(unique(participant)))"
"2","argument is not numeric or logical: returning NA"
"2","argument is not numeric or logical: returning NA"
"2","argument is not numeric or logical: returning NA"
"2","argument is not numeric or logical: returning NA"
"2","argument is not numeric or logical: returning NA"
"2","argument is not numeric or logical: returning NA"
"2","argument is not numeric or logical: returning NA"
"2","argument is not numeric or logical: returning NA"
"2","argument is not numeric or logical: returning NA"
"2","NAs introduced by coercion"
"2","NAs introduced by coercion"
"2","NAs introduced by coercion"
"2","`summarise()` regrouping output by 'condition' (override with `.groups` argument)
"
"0","# Plot: possibility of change"
"0","ggplot(predicted %>% filter(measure == ""Possibility of change""), aes(x = condition, y = response)) +"
"0","  ggtitle(""Possibility of change: simulated data"") +"
"0","  scale_y_continuous(breaks = c(1, 2, 3, 4),"
"0","                     labels = c(""For sure no: 1"", ""Maybe no: 2"", ""Maybe yes: 3"", ""For sure yes: 4"")) + "
"0","  geom_hline(yintercept = mean(c(1, 2, 3, 4)), linetype = ""dashed"") +"
"0","  geom_point(position = position_jitter(width = 0.2, height = 0.05),"
"0","             size = 2, alpha = 0.1) + "
"0","  stat_summary(fun.data = ""mean_cl_boot"","
"0","               position = position_dodge(width = 0.8),"
"0","               geom = ""linerange"","
"0","               size = 1) +"
"0","  stat_summary(fun = ""mean"","
"0","               position = position_dodge(width = 0.8),"
"0","               geom = ""point"","
"0","               shape = 21,"
"0","               color = ""black"","
"0","               fill = ""black"","
"2","
"
